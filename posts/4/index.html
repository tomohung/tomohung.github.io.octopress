
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>The Life Alchemist</title>
  <meta name="author" content="Tomo">

  
  <meta name="description" content="Chapter 7 - Treat Everything Like an Object—Because Everything Is Classes, Instances, Methods Class就像是容器，可以裝很多Method。Class也像是工廠，製造出很多副本Instances &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.tomohung.com/posts/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="The Life Alchemist" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-12830335-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">The Life Alchemist</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
  
  
  
  
  
    
      <form action="https://www.google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="sitesearch" value="www.tomohung.com" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/categories/tealeaf">Tealeaf</a></li>
  <li><a href="/about/index.html">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/04/eloquent-ruby-7/">Eloquent Ruby -7 [Treat Everything Like an Object—Because Everything Is]</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-04T06:19:26+08:00'><span class='date'>2015-05-04</span> <span class='time'>6:19 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Chapter 7 - Treat Everything Like an Object—Because Everything Is</h1>

<h2>Classes, Instances, Methods</h2>

<ul>
<li><p>Class就像是容器，可以裝很多Method。Class也像是工廠，製造出很多副本Instances</p></li>
<li><p>如果沒有指定superclass時，<code>Object</code>為預設繼承的類別。<code>Object</code>也是繼承了<code>BasicObject</code></p></li>
</ul>


<h2>Objects</h2>

<ul>
<li>反正什麼東西在Ruby裡面都是Object，可以測試這些</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-1.class
</span><span class='line'>true.class
</span><span class='line'>nil.class
</span><span class='line'>/regex/.class</span></code></pre></td></tr></table></div></figure>


<ul>
<li>如果puts出來，預設會用<code>to_s</code>轉換</li>
</ul>


<h2>eval</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cmd = 'gets'
</span><span class='line'>puts eval(cmd)</span></code></pre></td></tr></table></div></figure>


<p><code>eval</code>可以像irb執行字串所代表的程式，這也是由Object繼承而來的函數</p>

<h2>public, private, protected</h2>

<p>三種屬性來控制method的曝露性</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Method
</span><span class='line'>  def public_method
</span><span class='line'>    #預設為public，所有public method都可以呼叫
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  private # 在此之後方法都是private，只有在該instance內可以呼叫
</span><span class='line'>  def private_method
</span><span class='line'>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>也可以這樣寫，不過我還沒看過實際有人這樣寫</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Method
</span><span class='line'>  def private_method
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  private :prviate_method #在這指定private_method屬性是private</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>private內的方法繼承到subclass後，<strong>同樣可以呼叫</strong>，這跟在C++中不一樣</p></li>
<li><p>protected有夠難理解，原文是這樣的</p></li>
</ul>


<blockquote><p>Any instance of a class can call a protected method on any other instance of the class</p></blockquote>

<p>我是參考高見龍<a href="http://blog.eddie.com.tw/2011/07/26/public-protected-and-private-method-in-ruby/">這篇文章</a>才比較理解為什麼</p>

<p>可以在irb這樣測試</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Base
</span><span class='line'>  private 
</span><span class='line'>  def private_show
</span><span class='line'>    puts self.class
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  protected
</span><span class='line'>  def protected_show
</span><span class='line'>    puts self.class
</span><span class='line'>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>然後</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class SubBase &lt; Base
</span><span class='line'>  def use_private
</span><span class='line'>    private_show # 如果寫成self.private_show，會產生錯誤
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  def use_protected
</span><span class='line'>    self.protected_show # 可以指定在self這個instance上
</span><span class='line'>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>原生Ruby source code中，20萬行的程式碼，大約有1000個private methods, protected methods只有50幾個。意思就是用到的機會也不多啦。</p></li>
<li><p>另外Ruby也有個設計，如果你實在想突破限制使用class內的方法，可以用<code>send</code></p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sub_base.send(:private_show)</span></code></pre></td></tr></table></div></figure>


<p>不過一般的作法大概都是另外寫一個public method把private method包起來給外部呼叫。</p>

<ul>
<li>public, private, protected並不是什麼特別的Ruby Magic，其實他們都是methods，呼叫後面帶參數</li>
</ul>


<p>相同的還有<code>require</code>載入檔案</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>require 'rails_spec'</span></code></pre></td></tr></table></div></figure>


<p>或者是<code>attr_accessor</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>attr_accessor :name</span></code></pre></td></tr></table></div></figure>


<p>然後我們就可以有<code>name</code>的getter和setter方法</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/03/eloquent-ruby-6/">Eloquent Ruby -6 [Use Symbols to Stand for Something]</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-03T22:06:44+08:00'><span class='date'>2015-05-03</span> <span class='time'>10:06 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Chapter 6 - Use Symbols to Stand for Something</h1>

<p>String和Symbol很類似，都可以用來代表程式中的某個事物，但字串還多了可以被用來處理得到額外資訊，如果我們單純只是想要用來代表程式中的某個事物，用Symbol就可以了。</p>

<p>－ 同一個symbol永遠指著同一個物件，如</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>a = :sym 
</span><span class='line'>b= a
</span><span class='line'>c = :sym</span></code></pre></td></tr></table></div></figure>


<p>a, b, c都是相同的物件</p>

<p>但如果是string</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>a = "sym"
</span><span class='line'>b = "sym"</span></code></pre></td></tr></table></div></figure>


<p><code>a.equal? b</code> 會回傳false</p>

<ul>
<li>所有Ruby的物件都有一個<code>public_methods</code>的函數，會回傳一個Array of symbols</li>
</ul>


<hr />

<p>簡單總結這章，Symbol因為有著unique, immutable這兩個特性，在用來當作代表性詞時就很實用，尤其是在應用hash時。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/03/eloquent-ruby-5/">Eloquent Ruby -5 [Find the Right String With Regular Expressions]</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-03T20:38:53+08:00'><span class='date'>2015-05-03</span> <span class='time'>8:38 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Chapter 5 - Find the Right String with Regular Expressions</h1>

<h2>Match One Character</h2>

<ul>
<li><p><code>.</code>可以match任何單一字元(except new line)</p></li>
<li><p>如果想match <code>.</code>本身，可以用<code>\</code>，如<code>3\.14</code></p></li>
<li><p>再譬如<code>.r\.</code>，可以match <code>Mr.</code> or <code>Dr.</code></p></li>
</ul>


<h2>Sets, Range, Alternatives</h2>

<h3>Sets</h3>

<ul>
<li><p>例如<code>[0123456789]</code>可以match任何一個數字字元</p></li>
<li><p><code>[pPaA][Mm]</code>可以match <code>Am</code> or <code>pm</code>.</p></li>
</ul>


<h3>Range</h3>

<ul>
<li><p><code>[0-9a-f]</code>可以match任何一個16進位的字元</p></li>
<li><p><code>\d</code>可以match任何一個數字字元，<code>\d\d</code>可以match 連續2個數字字元</p></li>
<li><p><code>\w</code>可以match任何一個字元，包含數字、底線等</p></li>
<li><p><code>\s</code>可以match任何一個空白字元，包含space, tab, new line.</p></li>
</ul>


<h3>Alternatives</h3>

<ul>
<li><p><code>|</code>是替換符號</p></li>
<li><p><code>A\.M\.|AM|P\.M\.|PM</code> 可以match <code>A.M.</code> or <code>AM</code>, or <code>P.M.</code> or <code>PM</code></p></li>
<li><p>處理時間格式可以用 <code>\d\d:\d\d (AM|PM)</code></p></li>
</ul>


<h2>Asterist <code>*</code></h2>

<ul>
<li><p>*星號可以表示在星號前的字元有任意個，包含零個。</p></li>
<li><p><code>AB*</code>，可以match <code>AB</code>, <code>A</code>, or <code>ABBBB</code></p></li>
<li><p>所以可以用 <code>[0–9]*</code>，match任何長度的數字</p></li>
</ul>


<h2>Regular Expression in Ruby</h2>

<ul>
<li><p>Format regex by slash: <code>/\d\d:\d\d (AM|PM)/</code></p></li>
<li><p>use operator <code>=~</code></p></li>
<li><p>所以在irb中跑這段</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/\d\d:\d\d (AM|PM)/ =~ '10:24 PM'</span></code></pre></td></tr></table></div></figure>


<p>回傳<code>0</code>，這表示字串有符合，從index = 0的位置開始。</p>

<ul>
<li><p>如果沒有符合，回傳<code>nil</code></p></li>
<li><p>可以變成case insensitive，加上i，如：<code>/AM/i =~ 'am'</code></p></li>
<li><p>也可以當參數傳入gsub來用</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>time_string.gsub!( /\d\d:\d\d (AM|PM)/, '**:** **' )</span></code></pre></td></tr></table></div></figure>


<h2>Beginning and Ending</h2>

<ul>
<li><p>如果想要match字串的開頭用指定的文字，可以加入<code>\A</code>，如<code>\AIn the Beginning</code>，可以match字串前面為<code>In the Beginning</code></p></li>
<li><p>反過來如果想要match字串結尾用指定的文字，可以在尾巴加入<code>\z</code></p></li>
<li><p>如果想要match字串中<code>任何一行的開頭</code>有滿足，可以在條件字串前面加上<code>^</code></p></li>
<li><p>如果想要match字串中<code>任何一行的結尾</code>有滿足，可以在條件字串尾巴加上<code>$</code></p></li>
<li><p>如果想要進階同時match開頭跟結尾</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/^Once upon a time.*happily ever after\.$/</span></code></pre></td></tr></table></div></figure>


<p>這樣會失敗，因為<code>.</code>配合<code>*</code>雖然可以取代中間的任意數量的字元，但<code>.</code>不包含new line</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/^Once upon a time.*happily ever after\.$/m</span></code></pre></td></tr></table></div></figure>


<p>在結尾加上<code>m</code>可以關閉<code>.</code>這個特性。</p>

<ul>
<li><code>?</code>的作用和<code>*</code>類似</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/26/eloquent-ruby-4/">Eloquent Ruby -4 [Take Advantage of Ruby’s Smart Strings]</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-26T21:25:50+08:00'><span class='date'>2015-04-26</span> <span class='time'>9:25 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Chapter 4 - Take Advantage of Ruby’s Smart Strings</h1>

<p>string也和array, hash一樣有豐富的函式庫</p>

<p><a href="http://ruby-doc.org/core-2.2.2/String.html">http://ruby-doc.org/core-2.2.2/String.html</a></p>

<p>本章的結論就有Ruby提供的string非常好用，但壞處就是你要熟讀它。</p>

<hr />

<ul>
<li>double quoted string <code>"</code>, 比<code>'</code>還多了點用途</li>
</ul>


<p>像是在字串中加入變數時<code>#{}</code>，我常忘了用<code>'</code>就沒有這個效果。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"Hi, #{user.name}."</span></code></pre></td></tr></table></div></figure>


<ul>
<li>遇到很煩的字串含有一堆單引號雙引號，可以用</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>%q{"Oh No", "I can't tell what's the difference between 's' and "s"."}</span></code></pre></td></tr></table></div></figure>


<p>像上面的小寫q，也有對應用大寫Q的，效果就是像要加入變數時用：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>%Q{ "Hi, I'm #{user.name}."}</span></code></pre></td></tr></table></div></figure>


<ul>
<li>可以隨意斷行</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>multi_line_string = '你抓
</span><span class='line'>不到我
</span><span class='line'>'
</span><span class='line'>
</span><span class='line'>another_multi_line_string = %q{ 你抓
</span><span class='line'>不到我 }
</span></code></pre></td></tr></table></div></figure>


<p>如果不想有new line，可以用back slash</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>multi_line_with_no_new_line = '你抓\
</span><span class='line'>不到我'</span></code></pre></td></tr></table></div></figure>


<ul>
<li>超長文字可以這樣寫</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>really_long_string = &lt;&lt;EOF
</span><span class='line'>這是開頭
</span><span class='line'>...
</span><span class='line'>這是結尾
</span><span class='line'>EOF</span></code></pre></td></tr></table></div></figure>


<ul>
<li>chop &amp; chomp</li>
</ul>


<p>長的很像的兩個函數，用法天差地遠</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"a string with new line\n".chomp</span></code></pre></td></tr></table></div></figure>


<p>會回傳 <code>a string with new line</code>，尾巴的new line會截掉。注意如果結尾含有多個new line，它只會截掉一個。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"a string".chop</span></code></pre></td></tr></table></div></figure>


<p>會回傳&#8221;a strin&#8221;，回傳截掉最後一個字的結果。</p>

<ul>
<li>sub &amp; gsub</li>
</ul>


<p>替換字串內容</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>puts 'good good'.sub( 'good', 'bad' )
</span><span class='line'>puts 'good good'.gsub( 'good', 'bad' )</span></code></pre></td></tr></table></div></figure>


<p>得到的結果是</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>'bad good'
</span><span class='line'>'bad bad'</span></code></pre></td></tr></table></div></figure>


<ul>
<li>split 分割字串</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"one two three four five".split</span></code></pre></td></tr></table></div></figure>


<p>回傳一個矩陣</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>["one", "two", "three", "four", "five"]</span></code></pre></td></tr></table></div></figure>


<p>或是分割參數</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"one;two;three;four;five".split(";")</span></code></pre></td></tr></table></div></figure>


<p>回傳結果同上</p>

<ul>
<li>index 搜尋字串位置</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"actions speak louder than words".index("speak") # return 8</span></code></pre></td></tr></table></div></figure>


<ul>
<li>each_char, each_byte, each_line</li>
</ul>


<p>分別用迴圈回傳字元，位元數，每一行</p>

<ul>
<li>Ruby string is mutable</li>
</ul>


<p>mutable雖然翻譯是可變異，但我覺得它的意義和指標有點類似</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>street_name = 'taiwan street'
</span><span class='line'>road_name = street_name
</span><span class='line'>street_name.upcase!</span></code></pre></td></tr></table></div></figure>


<p>結果road_name = ?</p>

<p>注意像帶有!的函數常會有mutate的作用，所以上述結果road_name = &lsquo;TAIWAN STREET&rsquo;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/24/eloquent-ruby-3/">Eloquent Ruby -3 [Take Advantage of Ruby’s Smart Collections]</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-24T16:33:18+08:00'><span class='date'>2015-04-24</span> <span class='time'>4:33 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Chapter 3 - Take Advantage of Ruby’s Smart Collections</h1>

<p>直接結論，Ruby的Array跟Hash提供很多方便的函數可用，可以參考</p>

<p><a href="http://ruby-doc.org/core-2.2.0/Array.html">Array</a>
<a href="http://ruby-doc.org/core-2.2.0/Hash.html">Hash</a></p>

<p>以下才是正文開始</p>

<hr />

<ul>
<li>如果是要初始化一個給值的陣列，如</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>love_words = ["Nancy", "I", "love", "you"]</span></code></pre></td></tr></table></div></figure>


<p>也可以這樣產生</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>love_words = %w{ Nancy I love you }</span></code></pre></td></tr></table></div></figure>


<p>－ Ruby沒有指標，但是也有個類似指標的用法</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def echo_all( *args )
</span><span class='line'>  args.each { |arg| puts arg }
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>*暗示arg其實是個陣列值，可以遞進來做陣列處理。</p>

<ul>
<li>對於hash，可以這樣用</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>run( {speed: :fast, tools: :train} )</span></code></pre></td></tr></table></div></figure>


<p>也可以不要大括號，這樣寫</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>run( speed: :fast, tools: :train )</span></code></pre></td></tr></table></div></figure>


<p>甚至</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>run speed: :fast, tools: :train</span></code></pre></td></tr></table></div></figure>


<p>不過在參數只傳遞一個hash時，這樣寫蠻清爽的，如果是像form_for中要傳html_options時還這樣寫，簡直是個閱讀災難，我被誤導了好久。</p>

<p>－ 雖然array和hash都有提供each這個method，不過hash在使用上有些不一樣的地方</p>

<p>只給定一個參數的話</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hash_value = { one: 1, two: 2, three: 3 }
</span><span class='line'>
</span><span class='line'>hash_value.each do |value|
</span><span class='line'>  #something for value
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>value其實是個矩陣，如[:one, 1], [:two, 2], [:three, 3]。</p>

<p>也可以給2個參數</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hash_value.each do |key, value|
</span><span class='line'>  #something for value
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>key和value就分別對應到hash值上，這就不用多說了。</p>

<ul>
<li>另外有個<code>inject</code> method可以幫助加總所有元素</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def average_word_length
</span><span class='line'>  total = words.inject(0.0){ |result, word| word.size + result}
</span><span class='line'>  total / word_count
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>－ 不要再each裡面操作delete的動作，如果需要的話可以用<code>array.delete_if</code> method。</p>

<p>－ 如果只是要檢查某個元素有沒有已經存在陣列中，可以考慮改用<code>Set</code>這個class，而不是用Array。
<a href="http://ruby-doc.org/stdlib-2.2.2/libdoc/set/rdoc/Set.html">http://ruby-doc.org/stdlib-2.2.2/libdoc/set/rdoc/Set.html</a></p>

<p>它在檢查效率上比較好。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/5">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/3">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Tomo -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'tomohung';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
